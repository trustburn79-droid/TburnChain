ë„¤, ì •ë‹µì…ë‹ˆë‹¤! Redis**ëŠ” 32ê°œì˜ ì½”ì–´(í”„ë¡œì„¸ìŠ¤)ê°€ ì„œë¡œ "ë¡œê·¸ì¸ ì¥ë¶€"ë¥¼ ê³µìœ í•˜ê²Œ í•´ì£¼ëŠ” ì¤‘ì•™ ê²Œì‹œíŒ** ì—­í• ì„ í•©ë‹ˆë‹¤.

Redisë¥¼ ë¶™ì´ë©´ 32ê°œ ì½”ì–´ë¥¼ í’€ê°€ë™(`instances: "max"`) í•˜ë©´ì„œë„, ë¡œê·¸ì¸ ëŠê¹€ ì—†ì´ ì™„ë²½í•œ ì„¸ì…˜ ìœ ì§€ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—”í„°í”„ë¼ì´ì¦ˆ ì„œë²„ì˜ ì •ì„ ì„¸íŒ…ì´ì£ .

ì§€ê¸ˆ ë°”ë¡œ Redisë¥¼ ì„¤ì¹˜í•˜ê³  ì—°ë™í•˜ëŠ” 4ë‹¨ê³„ ë°©ë²•**ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.

---

### ğŸš€ 1ë‹¨ê³„: ì„œë²„ì— Redis ì„¤ì¹˜ (Ubuntu)

ë¨¼ì € ì„œë²„(êµ¬ê¸€ í´ë¼ìš°ë“œ í„°ë¯¸ë„)ì— Redis í”„ë¡œê·¸ë¨ì„ ê¹”ì•„ì•¼ í•©ë‹ˆë‹¤.

```bash
# 1. íŒ¨í‚¤ì§€ ëª©ë¡ ì—…ë°ì´íŠ¸ ë° Redis ì„¤ì¹˜
sudo apt update
sudo apt install redis-server -y

# 2. Redis ì„¤ì • íŒŒì¼ ì—´ê¸° (ë³´ì•ˆ ì„¤ì •)
sudo nano /etc/redis/redis.conf

```

[ìˆ˜ì •í•  ë¶€ë¶„]
`supervised`ë¼ëŠ” í•­ëª©ì„ ì°¾ì•„ì„œ `systemd`ë¡œ ë°”ê¿”ì£¼ì„¸ìš”. (Ctrl+Wë¡œ ê²€ìƒ‰í•˜ë©´ ë¹ ë¦…ë‹ˆë‹¤.)

```conf
supervised systemd

```

*(ì €ì¥: `Ctrl+O` -> `Enter` -> `Ctrl+X`)*

```bash
# 3. Redis ì¬ì‹œì‘ ë° ìë™ ì‹¤í–‰ ë“±ë¡
sudo systemctl restart redis.service
sudo systemctl enable redis.service

```

---

### ğŸ“¦ 2ë‹¨ê³„: Node.js í”„ë¡œì íŠ¸ì— ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜**

í”„ë¡œì íŠ¸ í´ë”(~/TburnChain ë“±)ë¡œ ì´ë™í•´ì„œ Redis ì—°ë™ ëª¨ë“ˆ 2ê°œë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

npm install redis connect-redis


---

### ğŸ’» 3ë‹¨ê³„: ì†ŒìŠ¤ ì½”ë“œ ìˆ˜ì • (`app.js` ë˜ëŠ” `index.ts`)

ì´ì œ "ì„¸ì…˜ì„ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ì§€ ë§ê³ , Redisì— ì €ì¥í•´!"**ë¼ê³  ì½”ë“œë¥¼ ë°”ê¿”ì•¼ í•©ë‹ˆë‹¤.
`express-session` ì„¤ì • ë¶€ë¶„ì„ ì°¾ì•„ì„œ ì•„ë˜ì²˜ëŸ¼ ë°”ê¿”ì£¼ì„¸ìš”.

[ìˆ˜ì • ì „ ì½”ë“œ (ì˜ˆì‹œ)]

```javascript
const session = require('express-session');

app.use(session({
    secret: 'mySecret',
    resave: false,
    saveUninitialized: true
}));

```

[ìˆ˜ì • í›„ ì½”ë“œ (Redis ì ìš©)]

```javascript
const session = require('express-session');
const RedisStore = require('connect-redis').default; // .default ì£¼ì˜!
const { createClient } = require('redis');

// 1. Redis í´ë¼ì´ì–¸íŠ¸ ìƒì„±
const redisClient = createClient();
redisClient.connect().catch(console.error);

// 2. ì„¸ì…˜ ì„¤ì •ì— RedisStore ì—°ê²°
app.use(session({
    store: new RedisStore({ client: redisClient }), // â˜… ì—¬ê¸°ê°€ í•µì‹¬!
    secret: 'your_secret_key', // ê¸°ì¡´ í‚¤ ê·¸ëŒ€ë¡œ ì‚¬ìš©
    resave: false,
    saveUninitialized: false,
    cookie: {
        secure: true, // HTTPS ì‚¬ìš© ì‹œ true (í•„ìˆ˜)
        httpOnly: true,
        maxAge: 1000 * 60 * 60 * 24 // ì¿ í‚¤ ìœ íš¨ê¸°ê°„ (ì˜ˆ: 1ì¼)
    },
    proxy: true // â˜… Nginx ë’¤ì— ìˆìœ¼ë¯€ë¡œ í•„ìˆ˜!
}));

```

*(Tip: `app.set('trust proxy', 1);` ì½”ë“œë„ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•©ë‹ˆë‹¤!)*

---

### ğŸš€ 4ë‹¨ê³„: `deploy.sh`ë¥¼ ë‹¤ì‹œ 'Max'ë¡œ ë³€ê²½**

ì´ì œ ì¤€ë¹„ê°€ ëë‚¬ìœ¼ë‹ˆ, 1ê°œë¡œ ì¤„ì˜€ë˜ ì„œë²„ë¥¼ ë‹¤ì‹œ 32ê°œ í’€ê°€ë™ ëª¨ë“œ**ë¡œ ë°”ê¿‰ë‹ˆë‹¤.

1. `nano deploy.sh`
2. ë‹¤ì‹œ **Cluster Mode**ë¡œ ë³µêµ¬:
```javascript
instances: "max",       // 32ê°œ ì½”ì–´ ì „ë¶€ ì‚¬ìš©! ğŸ”¥
exec_mode: "cluster",   // í´ëŸ¬ìŠ¤í„° ëª¨ë“œ í™œì„±í™”

```



---

### ğŸ‰ ê²°ê³¼ í™•ì¸**

ì´ì œ `./deploy.sh`ë¥¼ ì‹¤í–‰í•´ì„œ ë°°í¬í•˜ì„¸ìš”.

1. ì„±ëŠ¥: 32ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ëœ¨ë©´ì„œ `top` ëª…ë ¹ì–´ë¡œ ë³´ë©´ CPU ìì›ì´ ë„‰ë„‰í•´ì§ˆ ê²ƒì…ë‹ˆë‹¤.
2. ë¡œê·¸ì¸: 1ë²ˆ ì½”ì–´ì—ì„œ ë¡œê·¸ì¸í•˜ê³  ìƒˆë¡œê³ ì¹¨í•´ì„œ 15ë²ˆ ì½”ì–´ë¡œ íŠ€ì–´ë„, Redisë¼ëŠ” ê³µìš© ì¥ë¶€**ì—ì„œ ì •ë³´ë¥¼ í™•ì¸í•˜ë¯€ë¡œ **ë¡œê·¸ì¸ì´ ì ˆëŒ€ í’€ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì´ê²Œ ë°”ë¡œ **ëŒ€ìš©ëŸ‰ íŠ¸ë˜í”½ì„ ì²˜ë¦¬í•˜ëŠ” ì§„ì§œ ë©”ì¸ë„· ë…¸ë“œì˜ êµ¬ì„±**ì…ë‹ˆë‹¤. ë°”ë¡œ ì§„í–‰í•´ ë³´ì„¸ìš”!